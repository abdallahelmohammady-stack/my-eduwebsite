<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CCE Hub - ŸÖŸÉÿ™ÿ®ÿ© ÿßŸÑŸÖŸàÿßÿØ</title>
    <link rel="icon" href="favicone.png">
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts (Cairo) -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">

    <!-- Custom Styles -->
    <style>
        :root {
            --bg-body: #f1f5f9;
            --bg-card: #ffffff;
            --bg-hover: #e0e7ff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --primary: #4f46e5;
            --primary-dark: #3730a3;
            --accent: #06b6d4;
            --danger: #ef4444;
            --border-color: #cbd5e1;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            --radius: 12px;
            --modal-bg: rgba(15, 23, 42, 0.6);
        }

        .dark-mode {
            --bg-body: #0f172a;
            --bg-card: #1e293b;
            --bg-hover: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --accent: #22d3ee;
            --danger: #f87171;
            --border-color: #334155;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
            --modal-bg: rgba(0, 0, 0, 0.8);
        }

        body {
            font-family: 'Cairo', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-body);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            transition: background-color 0.3s, color 0.3s;
            background-image: radial-gradient(var(--text-secondary) 1px, transparent 1px);
            background-size: 30px 30px;
            font-size: 18px; /* ÿ™ŸÉÿ®Ÿäÿ± ÿßŸÑÿÆÿ∑ */
        }

        /* Header Styles */
        header {
            position: sticky;
            top: 0;
            z-index: 1000;
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-color);
            padding: 0.8rem 0;
            transition: 0.3s;
        }

        .dark-mode header {
            background: rgba(30, 41, 59, 0.9);
        }

        /* Card Styles */
        .material-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            padding: 2rem 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100%;
        }

        .material-card:hover {
            transform: translateY(-4px);
            border-color: var(--primary);
        }

        .material-card.dragging {
            opacity: 0.5;
            transform: scale(0.95);
            border: 2px dashed var(--primary);
        }

        .material-card.drag-over {
            border: 2px dashed var(--primary);
            background-color: var(--bg-hover);
        }

        /* Note Cards Specific Styles */
        .note-card {
            background: #fffbeb; /* Amber 50 */
            border: 1px solid #fcd34d;
            color: #78350f;
            border-radius: var(--radius);
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            min-height: 150px;
            transition: transform 0.2s, box-shadow 0.2s;
            position: relative;
        }
        
        .dark-mode .note-card {
            background: #451a03; /* Dark amber bg */
            border-color: #78350f;
            color: #fcd34d;
        }

        .note-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .note-date {
            font-size: 0.75rem;
            opacity: 0.7;
            margin-top: auto;
            padding-top: 1rem;
            text-align: left;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* Modal Styles */
        [role="dialog"] {
            width: 100%;
            max-width: 700px !important;
            background: var(--bg-card);
            padding: 2rem !important;
            border-radius: 16px !important;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            outline: none;
            animation: modalFadeIn 0.2s ease-out;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        .modal-backdrop {
            position: fixed;
            inset: 0;
            z-index: 50;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--modal-bg);
            backdrop-filter: blur(4px);
            padding: 1rem;
        }

        /* Utility Buttons & Inputs */
        .icon-btn {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-primary);
            cursor: pointer;
            transition: 0.3s;
        }

        .icon-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .form-input {
            width: 100%;
            padding: 0.85rem 1rem !important;
            border-radius: 10px !important;
            border: 2px solid var(--border-color) !important;
            background: var(--bg-body) !important;
            color: var(--text-primary) !important;
            font-size: 1rem !important;
            font-weight: 500 !important;
            transition: 0.2s;
            min-height: 48px;
        }

        .form-input:focus {
            border-color: var(--primary) !important;
            outline: none !important;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.15) !important;
        }

        /* Specific Classes */
        .search-input {
            width: 100%;
            padding: 0.6rem 2.5rem 0.6rem 1rem;
            background: var(--bg-card);
            border: 2px solid transparent;
            border-radius: var(--radius);
            color: var(--text-primary);
            font-weight: 600;
            transition: 0.3s;
        }

        .search-input:focus {
            border-color: var(--primary);
        }

        .action-btn {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            width: 28px;
            height: 28px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        .action-btn:hover {
            color: var(--primary);
            border-color: var(--primary);
        }
        
        .action-btn.delete:hover {
            color: var(--danger);
            border-color: var(--danger);
        }

        .track-item {
            display: flex;
            align-items: center;
            padding: 0.7rem 1rem;
            border-bottom: 1px solid var(--border-color);
            text-decoration: none;
            color: var(--text-primary);
            transition: 0.2s;
            cursor: pointer;
        }
        
        .track-item:hover {
            background-color: var(--bg-hover);
            padding-right: 1.2rem;
        }

        /* Standard Buttons */
        .btn-save {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.85rem 2.5rem;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 700;
            transition: 0.2s;
            min-height: 48px;
        }
        
        .btn-save:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
        }

        .btn-cancel {
            background: transparent;
            border: 2px solid var(--border-color);
            color: var(--text-secondary);
            padding: 0.85rem 2rem;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: 0.2s;
            min-height: 48px;
        }

        .btn-cancel:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
            border-color: var(--text-secondary);
        }

        .btn-delete {
            background: var(--danger);
            color: white;
            border: none;
            padding: 0.85rem 2rem;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: 0.2s;
            min-height: 48px;
        }

        .btn-delete:hover {
            opacity: 0.9;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
        }

        .add-course-btn-main {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: var(--radius);
            font-weight: 700;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin: 1rem auto;
            box-shadow: 0 4px 15px rgba(79, 70, 229, 0.3);
            transition: 0.3s;
        }
        
        .add-course-btn-main:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(79, 70, 229, 0.4);
        }

        .btn-add-note {
            background: #f59e0b;
            color: white;
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            transition: 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        .btn-add-note:hover {
            background: #d97706;
            box-shadow: 0 4px 10px rgba(245, 158, 11, 0.3);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Default courses data
        const defaultCourses = [
            {
                id: 'math3',
                title: 'ÿ±Ÿäÿßÿ∂ÿ© 3 ü´†',
                doc: 'D.E & S.V',
                icon: 'fa-calculator',
                sections: [
                    { name: 'ÿØŸÉÿ™Ÿàÿ± ÿ¥ŸäŸÖÿßÿ°', badge: 'D.E & S.V', links: [
                        { name: 'Differential Equations', url: 'https://youtube.com/playlist?list=PLDmD18oSY9IDFBY-Cxwov0DdietQdPrwY' },
                        { name: 'S.V (Vector Analysis)', url: 'https://youtube.com/playlist?list=PLDmD18oSY9IBpm38QhF93VM-GeEGNiRKo' }
                    ]},
                    { name: 'ÿØŸÉÿ™Ÿàÿ± ÿπÿ®ÿßÿ≥', badge: 'Course', links: [
                        { name: 'Playlist ÿ¥ÿßŸÖŸÑÿ©', url: 'https://youtube.com/playlist?list=PL1YWN9bMt3OBst07eIJhwj4U256qipeTz' }
                    ]}
                ],
                notes: [] // Initialize with empty array
            },
            {
                id: 'logic',
                title: 'ŸÑŸàÿ¨ŸäŸÉ 1',
                doc: 'Digital Logic',
                icon: 'fa-microchip',
                sections: [
                    { name: 'ÿØ/ ÿ£ÿ≠ŸÖÿØ ÿµÿßŸÑÿ≠ üëë', badge: 'King', links: [
                        { name: 'Playlist 1', url: 'https://youtube.com/playlist?list=PL58RkuffQs13k6P5uItCg8nA0Hi3oU2TY' }
                    ]}
                ],
                notes: []
            },
            {
                id: 'circuits',
                title: 'ÿØŸàÿßÿ¶ÿ± ŸÉŸáÿ±ÿ®Ÿäÿ©',
                doc: 'Electrical Circuits',
                icon: 'fa-plug-circle-bolt',
                sections: [
                    { name: 'ÿØ Ÿäÿßÿ≥ÿ± ÿßŸÑÿ®ÿ∑ÿßŸàŸä', badge: 'YouTube', links: [
                        { name: 'Playlist ÿ¥ÿßŸÖŸÑÿ©', url: 'https://youtube.com/playlist?list=PLka1IWY71Cp_iANs3ir4JjB0bSg8lXTgH' }
                    ]}
                ],
                notes: []
            },
            {
                id: 'electronics',
                title: 'ÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸäÿßÿ™',
                doc: 'Electronics',
                icon: 'fa-memory',
                sections: [
                    { name: 'ÿØ/ ŸÜŸäŸáÿßŸÑ', badge: 'Prof', links: [
                        { name: 'Playlist ÿ¥ÿßŸÖŸÑÿ©', url: 'https://youtube.com/playlist?list=PL3MBZqVIYGpnKfbDRv-WsSqkK_B67TbeQ' }
                    ]}
                ],
                notes: []
            },
            {
                id: 'prob',
                title: 'ŸÜÿ∏ÿ±Ÿäÿ© ÿßÿ≠ÿ™ŸÖÿßŸÑÿßÿ™',
                doc: 'Probability & Stats',
                icon: 'fa-chart-pie',
                sections: [
                    { name: 'ŸÖŸÑŸÅÿßÿ™ ÿßŸÑÿØŸÉÿ™Ÿàÿ±', badge: 'Drive', links: [
                        { name: 'ŸÅÿ™ÿ≠ ÿßŸÑŸÖÿ¨ŸÑÿØ', url: 'https://drive.google.com/drive/folders/1pKkvp1MY38gWNj8Xumpf5o6uvp6wk2M_' }
                    ]}
                ],
                notes: []
            },
            {
                id: 'exams',
                title: 'ŸÖÿ≥ÿ™ŸàÿØÿπ ÿßŸÑÿßŸÖÿ™ÿ≠ÿßŸÜÿßÿ™',
                doc: 'Archive',
                icon: 'fa-folder-open',
                sections: [
                    { name: 'ÿßŸÑÿßŸÖÿ™ÿ≠ÿßŸÜÿßÿ™ ÿßŸÑÿ≥ÿßÿ®ŸÇÿ©', badge: 'Exam', links: [
                        { name: 'ŸÅÿ™ÿ≠ ÿßŸÑŸÖÿ≥ÿ™ŸàÿØÿπ', url: 'https://drive.google.com/folderview?id=1vr4h0p0mhFlJ4p12Vxm1urYIkMAKAG2q' }
                    ]}
                ],
                notes: []
            }
        ];

        function CCEHub() {
            const [allCourses, setAllCourses] = useState(() => {
                if (typeof window === 'undefined') return []
                const storedCourses = localStorage.getItem('allCourses')
                if (storedCourses) {
                    try {
                        const parsed = JSON.parse(storedCourses)
                        // Ensure notes is an array for backward compatibility
                        const sanitized = parsed.map(c => ({...c, notes: Array.isArray(c.notes) ? c.notes : []}))
                        return sanitized.length > 0 ? sanitized : defaultCourses
                    } catch (e) {
                        return defaultCourses
                    }
                }
                return defaultCourses
            })
            const [currentCourseId, setCurrentCourseId] = useState(null)
            const [view, setView] = useState('home')
            const [searchTerm, setSearchTerm] = useState('')
            const [currentIconBase64, setCurrentIconBase64] = useState(null)
            const [theme, setTheme] = useState(() => {
                if (typeof window !== 'undefined') {
                    return (localStorage.getItem('theme')) || 'light'
                }
                return 'light'
            })

            // Note Modal State
            const [noteModalOpen, setNoteModalOpen] = useState(false)
            const [editingNoteId, setEditingNoteId] = useState(null)
            const [tempNoteContent, setTempNoteContent] = useState('')

            // Modals state
            const [courseModalOpen, setCourseModalOpen] = useState(false)
            const [linkModalOpen, setLinkModalOpen] = useState(false)
            const [editLinkModalOpen, setEditLinkModalOpen] = useState(false)
            const [editingCourseId, setEditingCourseId] = useState(null)
            const [editingSectionIndex, setEditingSectionIndex] = useState(null)
            const [editingLinkIndex, setEditingLinkIndex] = useState(null)
            const [targetSectionIndex, setTargetSectionIndex] = useState(null)

            // Form state
            const [courseName, setCourseName] = useState('')
            const [courseDoc, setCourseDoc] = useState('')
            const [linkName, setLinkName] = useState('')
            const [linkUrl, setLinkUrl] = useState('')
            const [editLinkName, setEditLinkName] = useState('')
            const [editLinkUrl, setEditLinkUrl] = useState('')

            // Drag and drop state
            const [draggedLinkInfo, setDraggedLinkInfo] = useState(null)
            const [draggedCourseIndex, setDraggedCourseIndex] = useState(null)
            const [draggedSectionIndex, setDraggedSectionIndex] = useState(null)

            const fileInputRef = useRef(null)

            // Effects
            useEffect(() => {
                try {
                    localStorage.setItem('allCourses', JSON.stringify(allCourses))
                } catch (e) {
                    alert('ÿ™ŸÜÿ®ŸäŸá: ŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑÿ™ÿÆÿ≤ŸäŸÜ ŸÖŸÖÿ™ŸÑÿ¶ÿ©. ÿ≠ÿßŸàŸÑ ÿ≠ÿ∞ŸÅ ÿ®ÿπÿ∂ ÿßŸÑŸÖŸàÿßÿØ ÿ£Ÿà ÿßŸÑÿµŸàÿ± ÿßŸÑŸÉÿ®Ÿäÿ±ÿ©.')
                }
            }, [allCourses])

            useEffect(() => {
                localStorage.setItem('theme', theme)
                if(theme === 'dark') {
                    document.body.classList.add('dark-mode')
                } else {
                    document.body.classList.remove('dark-mode')
                }
            }, [theme])

            // Note Handlers
            const openAddNoteModal = () => {
                setEditingNoteId(null)
                setTempNoteContent('')
                setNoteModalOpen(true)
            }

            const openEditNoteModal = (note) => {
                setEditingNoteId(note.id)
                setTempNoteContent(note.content)
                setNoteModalOpen(true)
            }

            const saveNote = () => {
                if (!tempNoteContent.trim()) return

                setAllCourses(prev => prev.map(course => {
                    if (course.id === currentCourseId) {
                        let newNotes = [...course.notes]
                        if (editingNoteId) {
                            // Update existing
                            newNotes = newNotes.map(n => n.id === editingNoteId 
                                ? { ...n, content: tempNoteContent.trim(), updatedAt: new Date().toISOString() } 
                                : n)
                        } else {
                            // Add new
                            newNotes.push({
                                id: Date.now(),
                                content: tempNoteContent.trim(),
                                createdAt: new Date().toISOString()
                            })
                        }
                        return { ...course, notes: newNotes }
                    }
                    return course
                }))
                setNoteModalOpen(false)
            }

            const deleteNote = (noteId) => {
                if(confirm('ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ≠ÿ∞ŸÅ Ÿáÿ∞Ÿá ÿßŸÑŸÖŸÑÿßÿ≠ÿ∏ÿ©ÿü')) {
                    setAllCourses(prev => prev.map(course => {
                        if (course.id === currentCourseId) {
                            return { ...course, notes: course.notes.filter(n => n.id !== noteId) }
                        }
                        return course
                    }))
                }
            }

            const formatDate = (isoString) => {
                const date = new Date(isoString)
                return date.toLocaleDateString('ar-EG', { year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute:'2-digit' })
            }

            // Helpers
            const getIcon = (name) => {
                const n = name.toLowerCase()
                if (n.includes('ÿ±Ÿäÿßÿ∂') || n.includes('math')) return 'fa-calculator'
                if (n.includes('ŸÅŸäÿ≤') || n.includes('phys')) return 'fa-bolt'
                if (n.includes('ÿØÿßÿ¶ÿ±') || n.includes('circ') || n.includes('ŸÉŸáÿ±ÿ®')) return 'fa-plug-circle-bolt'
                if (n.includes('ÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜ') || n.includes('electr')) return 'fa-memory'
                if (n.includes('ŸÑŸàÿ¨ŸäŸÉ') || n.includes('log') || n.includes('ÿ®ÿ±ŸÖÿ¨ÿ©') || n.includes('prog')) return 'fa-microchip'
                if (n.includes('ÿßÿ≠ÿ™ŸÖÿßŸÑ') || n.includes('stat')) return 'fa-chart-pie'
                if (n.includes('ÿßŸÖÿ™ÿ≠ÿßŸÜ') || n.includes('exam') || n.includes('ŸÖŸàÿØ')) return 'fa-file-shield'
                return 'fa-book'
            }

            const toggleTheme = () => {
                setTheme(prev => prev === 'light' ? 'dark' : 'light')
            }

            const openCourseModal = () => {
                setEditingCourseId(null)
                setCurrentIconBase64(null)
                setCourseName('')
                setCourseDoc('')
                setCourseModalOpen(true)
            }

            const openEditCourseModal = (courseId) => {
                const course = allCourses.find(c => c.id === courseId)
                if (!course) return
                setEditingCourseId(courseId)
                setCurrentIconBase64(null)
                setCourseName(course.title)
                setCourseDoc(course.doc)
                setCourseModalOpen(true)
            }

            const saveCourseData = () => {
                if (!courseName.trim() || !courseDoc.trim()) {
                    alert('Ÿäÿ±ÿ¨Ÿâ ŸÖŸÑÿ° ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ŸÇŸàŸÑ')
                    return
                }

                if (editingCourseId) {
                    setAllCourses(prev => prev.map(course => {
                        if (course.id === editingCourseId) {
                            return {
                                ...course,
                                title: courseName.trim(),
                                doc: courseDoc.trim(),
                                icon: currentIconBase64 || course.icon
                            }
                        }
                        return course
                    }))
                } else {
                    const newCourse = {
                        id: `course-${Date.now()}`,
                        title: courseName.trim(),
                        doc: courseDoc.trim(),
                        icon: currentIconBase64 || getIcon(courseName),
                        sections: [],
                        notes: []
                    }
                    setAllCourses(prev => [...prev, newCourse])
                }
                setCourseModalOpen(false)
            }

            const deleteCourse = (courseId) => {
                if (confirm('ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿßŸÑÿ≠ÿ∞ŸÅÿü')) {
                    setAllCourses(prev => prev.filter(c => c.id !== courseId))
                    if (currentCourseId === courseId) {
                        showHome()
                    }
                }
            }

            const openDetail = (courseId) => {
                setCurrentCourseId(courseId)
                setView('detail')
            }

            const showHome = () => {
                setCurrentCourseId(null)
                setView('home')
            }

            const openLinkModal = (sectionIndex = null) => {
                setTargetSectionIndex(sectionIndex)
                setLinkName('')
                setLinkUrl('')
                setLinkModalOpen(true)
            }

            const saveLinkData = () => {
                if (!linkName.trim() || !linkUrl.trim()) {
                    alert('Ÿäÿ±ÿ¨Ÿâ ŸÖŸÑÿ° ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™')
                    return
                }

                setAllCourses(prev => prev.map(course => {
                    if (course.id === currentCourseId) {
                        if (targetSectionIndex !== null) {
                            const newSections = [...course.sections]
                            newSections[targetSectionIndex].links.push({
                                name: linkName.trim(),
                                url: linkUrl.trim()
                            })
                            return { ...course, sections: newSections }
                        } else {
                            return {
                                ...course,
                                sections: [
                                    ...course.sections,
                                    {
                                        name: `ŸÇÿ≥ŸÖ ÿ¨ÿØŸäÿØ ${course.sections.length + 1}`,
                                        badge: 'ŸÖÿ∂ÿßŸÅ',
                                        links: [{ name: linkName.trim(), url: linkUrl.trim() }]
                                    }
                                ]
                            }
                        }
                    }
                    return course
                }))
                setLinkModalOpen(false)
            }

            const deleteLink = (courseId, sectionIndex, linkIndex) => {
                if (confirm('ÿ≠ÿ∞ŸÅ Ÿáÿ∞ÿß ÿßŸÑÿ±ÿßÿ®ÿ∑ÿü')) {
                    setAllCourses(prev => prev.map(course => {
                        if (course.id === courseId) {
                            const newSections = [...course.sections]
                            newSections[sectionIndex].links.splice(linkIndex, 1)
                            if (newSections[sectionIndex].links.length === 0) {
                                newSections.splice(sectionIndex, 1)
                            }
                            return { ...course, sections: newSections }
                        }
                        return course
                    }))
                }
            }

            const openEditLinkModal = (courseId, sectionIndex, linkIndex) => {
                const course = allCourses.find(c => c.id === courseId)
                if (!course) return
                const link = course.sections[sectionIndex].links[linkIndex]
                setEditingCourseId(courseId)
                setEditingSectionIndex(sectionIndex)
                setEditingLinkIndex(linkIndex)
                setEditLinkName(link.name)
                setEditLinkUrl(link.url)
                setEditLinkModalOpen(true)
            }

            const saveEditedLink = () => {
                if (!editLinkName.trim() || !editLinkUrl.trim()) {
                    alert('Ÿäÿ±ÿ¨Ÿâ ŸÖŸÑÿ° ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™')
                    return
                }
                if (editingCourseId !== null && editingSectionIndex !== null && editingLinkIndex !== null) {
                    setAllCourses(prev => prev.map(course => {
                        if (course.id === editingCourseId) {
                            const newSections = [...course.sections]
                            newSections[editingSectionIndex].links[editingLinkIndex] = {
                                name: editLinkName.trim(),
                                url: editLinkUrl.trim()
                            }
                            return { ...course, sections: newSections }
                        }
                        return course
                    }))
                }
                setEditLinkModalOpen(false)
            }

            const editSectionName = (courseId, sectionIndex) => {
                const course = allCourses.find(c => c.id === courseId)
                if (!course) return
                const newName = prompt('ÿ£ÿØÿÆŸÑ ÿßŸÑÿßÿ≥ŸÖ ÿßŸÑÿ¨ÿØŸäÿØ ŸÑŸÑÿÆÿßŸÜÿ©:', course.sections[sectionIndex].name)
                if (newName && newName.trim()) {
                    setAllCourses(prev => prev.map(course => {
                        if (course.id === courseId) {
                            const newSections = [...course.sections]
                            newSections[sectionIndex].name = newName.trim()
                            return { ...course, sections: newSections }
                        }
                        return course
                    }))
                }
            }

            const deleteSection = (courseId, sectionIndex) => {
                if (confirm('ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ≠ÿ∞ŸÅ Ÿáÿ∞Ÿá ÿßŸÑÿÆÿßŸÜÿ©ÿü')) {
                    setAllCourses(prev => prev.map(course => {
                        if (course.id === courseId) {
                            const newSections = [...course.sections]
                            newSections.splice(sectionIndex, 1)
                            return { ...course, sections: newSections }
                        }
                        return course
                    }))
                }
            }

            // Drag & Drop Handlers (Kept as is)
            const handleLinkDragStart = (e, sectionIndex, linkIndex) => {
                setDraggedLinkInfo({ sectionIndex, linkIndex })
                e.dataTransfer.effectAllowed = 'move'
            }

            const handleLinkDragOver = (e) => {
                e.preventDefault()
                e.dataTransfer.dropEffect = 'move'
            }

            const handleLinkDrop = (e, targetSectionIndex, targetLinkIndex) => {
                e.preventDefault()
                if (!draggedLinkInfo || !currentCourseId) return
                const { sectionIndex: sourceSectionIndex, linkIndex: sourceLinkIndex } = draggedLinkInfo

                if (sourceSectionIndex === targetSectionIndex && sourceLinkIndex === targetLinkIndex) {
                    setDraggedLinkInfo(null)
                    return
                }

                setAllCourses(prev => prev.map(course => {
                    if (course.id === currentCourseId) {
                        const newSections = [...course.sections]
                        const [draggedLink] = newSections[sourceSectionIndex].links.splice(sourceLinkIndex, 1)
                        newSections[targetSectionIndex].links.splice(targetLinkIndex, 0, draggedLink)
                        const filteredSections = newSections.filter(s => s.links.length > 0)
                        return { ...course, sections: filteredSections }
                    }
                    return course
                }))
                setDraggedLinkInfo(null)
            }

            const handleCourseDragStart = (e, courseIndex) => {
                setDraggedCourseIndex(courseIndex)
                e.dataTransfer.effectAllowed = 'move'
            }

            const handleCourseDragOver = (e) => {
                e.preventDefault()
                e.dataTransfer.dropEffect = 'move'
            }

            const handleCourseDrop = (e, targetIndex) => {
                e.preventDefault()
                if (draggedCourseIndex === null || draggedCourseIndex === targetIndex) {
                    setDraggedCourseIndex(null)
                    return
                }
                setAllCourses(prev => {
                    const newCourses = [...prev]
                    const [draggedCourse] = newCourses.splice(draggedCourseIndex, 1)
                    newCourses.splice(targetIndex, 0, draggedCourse)
                    return newCourses
                })
                setDraggedCourseIndex(null)
            }

            const handleSectionDragStart = (e, sectionIndex) => {
                setDraggedSectionIndex(sectionIndex)
                e.dataTransfer.effectAllowed = 'move'
            }

            const handleSectionDragOver = (e) => {
                e.preventDefault()
                e.dataTransfer.dropEffect = 'move'
            }

            const handleSectionDrop = (e, targetIndex) => {
                e.preventDefault()
                if (draggedSectionIndex === null || draggedSectionIndex === targetIndex) {
                    setDraggedSectionIndex(null)
                    return
                }
                setAllCourses(prev => prev.map(course => {
                    if (course.id === currentCourseId) {
                        const newSections = [...course.sections]
                        const [draggedSection] = newSections.splice(draggedSectionIndex, 1)
                        newSections.splice(targetIndex, 0, draggedSection)
                        return { ...course, sections: newSections }
                    }
                    return course
                }))
                setDraggedSectionIndex(null)
            }

            const handleImageUpload = (e) => {
                const file = e.target.files?.[0]
                if (file) {
                    if (file.type !== 'image/png') {
                        alert('Ÿäÿ±ÿ¨Ÿâ ÿßÿÆÿ™Ÿäÿßÿ± ŸÖŸÑŸÅ ÿ®ÿµŸäÿ∫ÿ© PNG ŸÅŸÇÿ∑')
                        return
                    }
                    const reader = new FileReader()
                    reader.onload = (event) => {
                        setCurrentIconBase64(event.target?.result)
                    }
                    reader.readAsDataURL(file)
                }
            }

            const filteredCourses = allCourses.filter(course => {
                const term = searchTerm.toLowerCase()
                return course.title.toLowerCase().includes(term) || course.doc.toLowerCase().includes(term)
            })

            const currentCourse = allCourses.find(c => c.id === currentCourseId)

            return (
                <div className={`min-h-screen flex flex-col transition-colors duration-300 ${theme === 'dark' ? 'dark-mode' : ''}`}>
                    {/* Header */}
                    <header>
                        <div className={`${view === 'detail' ? 'max-w-full px-4 md:px-8' : 'max-w-6xl'} mx-auto flex justify-between items-center`}>
                            <div className="flex items-center gap-3 text-xl font-black text-[var(--primary-dark)] cursor-pointer" onClick={showHome}>
                                <i className="fa-solid fa-network-wired text-[var(--accent)]"></i> CCE Hub
                            </div>
                            
                            <div className="flex items-center gap-4">
                                <button className="icon-btn" onClick={toggleTheme} title="ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑÿ´ŸäŸÖ">
                                    <i className={`fa-solid ${theme === 'light' ? 'fa-moon' : 'fa-sun'}`}></i>
                                </button>
                                <div className="relative w-full max-w-[280px]">
                                    <input
                                        type="text"
                                        className="search-input"
                                        placeholder="ÿßÿ®ÿ≠ÿ´ ÿπŸÜ ŸÖÿßÿØÿ©..."
                                        value={searchTerm}
                                        onChange={(e) => setSearchTerm(e.target.value)}
                                    />
                                    <i className="fa-solid fa-search absolute right-3 top-1/2 -translate-y-1/2 text-[var(--text-secondary)]"></i>
                                </div>
                            </div>
                        </div>
                    </header>

                    <main className={`${view === 'detail' ? 'w-full px-4 md:px-8' : 'max-w-6xl'} mx-auto py-8 flex-1 min-h-[70vh]`}>
                        {/* Home View */}
                        {view === 'home' && (
                            <div>
                                <div className="text-center mb-8">
                                    <h1 className="text-3xl font-bold mb-2 text-[var(--text-primary)]">ŸÖŸÉÿ™ÿ®ÿ© ŸÇÿ≥ŸÖ ŸáŸÜÿØÿ≥ÿ© ÿßŸÑÿ•ÿ™ÿµÿßŸÑÿßÿ™ ŸàÿßŸÑÿ≠ÿßÿ≥ÿ®ÿßÿ™</h1>
                                    <p className="text-[var(--text-secondary)] text-sm">ÿßŸÑŸÜÿ∏ÿßŸÖ ÿßŸÑŸÖŸàÿ≠ÿØ ŸÑÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖŸàÿßÿØ (ŸäŸÖŸÉŸÜŸÉ ÿßŸÑÿ™ÿπÿØŸäŸÑ ŸàÿßŸÑÿ≠ÿ∞ŸÅ Ÿàÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™)</p>
                                </div>

                                <div className="text-center">
                                    <button className="add-course-btn-main" onClick={openCourseModal}>
                                        <i className="fa-solid fa-plus-circle"></i> ÿ•ÿ∂ÿßŸÅÿ© ŸÖŸÇÿ±ÿ± ÿ¨ÿØŸäÿØ
                                    </button>
                                </div>

                                <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 mt-8">
                                    {filteredCourses.map((course, index) => (
                                        <div
                                            key={course.id}
                                            className={`material-card ${draggedCourseIndex === index ? 'dragging' : ''}`}
                                            draggable
                                            onDragStart={(e) => handleCourseDragStart(e, index)}
                                            onDragOver={handleCourseDragOver}
                                            onDrop={(e) => handleCourseDrop(e, index)}
                                            onDragLeave={(e) => e.currentTarget.classList.remove('drag-over')}
                                            onDragEnter={(e) => {
                                                if (draggedCourseIndex !== null && draggedCourseIndex !== index) {
                                                    e.currentTarget.classList.add('drag-over')
                                                }
                                            }}
                                            onClick={(e) => {
                                                if (!e.target.closest('.card-actions') && !e.target.closest('.course-drag-handle')) {
                                                    openDetail(course.id)
                                                }
                                            }}
                                        >
                                            <i className="fa-solid fa-grip-vertical course-drag-handle absolute top-2.5 right-2.5 opacity-0 hover:opacity-100 cursor-grab text-[var(--text-secondary)] z-10 transition-opacity"></i>
                                            
                                            <div className="card-actions absolute top-2.5 left-2.5 flex gap-1 opacity-0 hover:opacity-100 z-10 transition-opacity">
                                                <button className="action-btn" onClick={(e) => { e.stopPropagation(); openEditCourseModal(course.id) }} title="ÿ™ÿπÿØŸäŸÑ">
                                                    <i className="fa-solid fa-pen"></i>
                                                </button>
                                                <button className="action-btn delete" onClick={(e) => { e.stopPropagation(); deleteCourse(course.id) }} title="ÿ≠ÿ∞ŸÅ">
                                                    <i className="fa-solid fa-trash"></i>
                                                </button>
                                            </div>
                                            
                                            <div className="w-16 h-16 bg-gradient-to-br from-[var(--bg-body)] to-white text-[var(--primary)] rounded-xl flex items-center justify-center text-3xl mx-auto mb-4 border-2 border-[var(--border-color)] overflow-hidden transition-colors hover:bg-[var(--primary)] hover:text-white hover:border-[var(--primary)]">
                                                {course.icon.startsWith('data:image') ? (
                                                    <img src={course.icon} alt={course.title} className="w-full h-full object-cover" />
                                                ) : (
                                                    <i className={`fa-solid ${course.icon}`}></i>
                                                )}
                                            </div>
                                            <div className="font-bold text-lg text-[var(--text-primary)]">{course.title}</div>
                                            <div className="text-sm text-[var(--text-secondary)]">{course.doc}</div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* Detail View */}
                        {view === 'detail' && currentCourse && (
                            <div className="w-full">
                                <button className="bg-[var(--bg-card)] border border-[var(--border-color)] text-[var(--text-secondary)] px-4 py-2 rounded-lg cursor-pointer font-semibold flex items-center gap-2 mb-6 hover:bg-[var(--primary)] hover:text-white hover:border-[var(--primary)] transition-all" onClick={showHome}>
                                    <i className="fa-solid fa-arrow-right"></i> ÿπŸàÿØÿ© ŸÑŸÑŸÇÿßÿ¶ŸÖÿ©
                                </button>
                                
                                <div className="max-w-4xl mx-auto bg-[var(--bg-card)] p-8 rounded-2xl shadow-sm text-center border border-[var(--border-color)] mb-8">
                                    <div className="w-20 h-20 bg-[var(--bg-body)] rounded-full flex items-center justify-center text-4xl text-[var(--accent)] mx-auto mb-4 border-4 border-[var(--accent)] overflow-hidden">
                                        {currentCourse.icon.startsWith('data:image') ? (
                                            <img src={currentCourse.icon} alt={currentCourse.title} className="w-full h-full object-cover" />
                                        ) : (
                                            <i className={`fa-solid ${currentCourse.icon}`}></i>
                                        )}
                                    </div>
                                    <h2 className="text-3xl font-extrabold text-[var(--primary-dark)] mb-1">{currentCourse.title}</h2>
                                    <p className="text-lg text-[var(--text-secondary)] mb-6">{currentCourse.doc}</p>
                                    
                                    <div className="flex justify-center gap-3 flex-wrap">
                                        <button className="bg-[var(--text-secondary)] text-white border-none px-4 py-2 rounded-lg cursor-pointer flex items-center gap-2 hover:opacity-90" onClick={() => openEditCourseModal(currentCourse.id)}>
                                            <i className="fa-solid fa-pen"></i> ÿ™ÿπÿØŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖŸÇÿ±ÿ±
                                        </button>
                                        <button className="bg-[var(--accent)] text-white border-none px-4 py-2 rounded-lg cursor-pointer flex items-center gap-2 hover:opacity-90" onClick={() => openLinkModal(null)}>
                                            <i className="fa-solid fa-plus"></i> ÿ•ÿ∂ÿßŸÅÿ© ÿ±ÿßÿ®ÿ∑ / ŸÇÿ≥ŸÖ ÿ¨ÿØŸäÿØ
                                        </button>
                                    </div>
                                </div>

                                {/* Notes Board Section (The Corner) */}
                                <div className="max-w-5xl mx-auto mb-10">
                                    <div className="flex justify-between items-center mb-4 px-2">
                                        <h3 className="text-xl font-bold text-[var(--text-primary)] flex items-center gap-2">
                                            <i className="fa-solid fa-clipboard-list text-[#f59e0b]"></i>
                                            ÿ≥ÿ¨ŸÑ ÿßŸÑŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™
                                        </h3>
                                        <button className="btn-add-note" onClick={openAddNoteModal}>
                                            <i className="fa-solid fa-plus"></i> ŸÖŸÑÿßÿ≠ÿ∏ÿ© ÿ¨ÿØŸäÿØÿ©
                                        </button>
                                    </div>
                                    
                                    {currentCourse.notes && currentCourse.notes.length > 0 ? (
                                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                            {currentCourse.notes.map((note) => (
                                                <div key={note.id} className="note-card">
                                                    <div className="text-lg font-medium whitespace-pre-wrap break-words">{note.content}</div>
                                                    <div className="note-date">
                                                        <span>{formatDate(note.createdAt)}</span>
                                                        <div className="flex gap-2">
                                                            <button onClick={() => openEditNoteModal(note)} className="hover:text-[var(--primary)]"><i className="fa-solid fa-pen"></i></button>
                                                            <button onClick={() => deleteNote(note.id)} className="hover:text-[var(--danger)]"><i className="fa-solid fa-trash"></i></button>
                                                        </div>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    ) : (
                                        <div className="text-center py-8 border-2 border-dashed border-[var(--border-color)] rounded-xl text-[var(--text-secondary)] bg-[var(--bg-card)]">
                                            ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ ÿ®ÿπÿØ. ÿßÿ∂ÿ∫ÿ∑ "ŸÖŸÑÿßÿ≠ÿ∏ÿ© ÿ¨ÿØŸäÿØÿ©" ŸÑÿ™ÿ≥ÿ¨ŸäŸÑ ÿ£ŸÅŸÉÿßÿ±ŸÉ.
                                        </div>
                                    )}
                                </div>

                                <div className="w-full">
                                    {currentCourse.sections.length === 0 ? (
                                        <div className="text-center text-[var(--text-secondary)] py-8">ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ£ŸÇÿ≥ÿßŸÖ ÿ£Ÿà ÿ±Ÿàÿßÿ®ÿ∑ ŸÖÿ∂ÿßŸÅÿ©. ÿßÿ∂ÿ∫ÿ∑ "ÿ•ÿ∂ÿßŸÅÿ© ÿ±ÿßÿ®ÿ∑ / ŸÇÿ≥ŸÖ ÿ¨ÿØŸäÿØ".</div>
                                    ) : (
                                        currentCourse.sections.map((section, sIndex) => (
                                            <div
                                                key={sIndex}
                                                className={`bg-[var(--bg-card)] rounded-xl border border-[var(--border-color)] overflow-hidden shadow-sm mb-6 ${draggedSectionIndex === sIndex ? 'dragging' : ''}`}
                                                draggable
                                                onDragStart={(e) => handleSectionDragStart(e, sIndex)}
                                                onDragOver={handleSectionDragOver}
                                                onDrop={(e) => handleSectionDrop(e, sIndex)}
                                                onDragLeave={(e) => e.currentTarget.classList.remove('drag-over')}
                                                onDragEnter={(e) => { if (draggedSectionIndex !== null && draggedSectionIndex !== sIndex) e.currentTarget.classList.add('drag-over') }}
                                            >
                                                <div className="bg-[var(--bg-body)] p-3 border-b border-[var(--border-color)] flex justify-between items-center flex-wrap gap-2 cursor-grab active:cursor-grabbing">
                                                    <div className="flex items-center gap-3 flex-1 min-w-0">
                                                        <i className="fa-solid fa-grip-vertical text-[var(--text-secondary)] cursor-grab hover:text-[var(--primary)]"></i>
                                                        <span className="font-bold text-[var(--primary)] text-lg truncate flex-1">{section.name}</span>
                                                        {section.badge && <span className="text-[0.7rem] bg-[var(--accent)] text-white px-2 py-0.5 rounded">{section.badge}</span>}
                                                    </div>
                                                    <div className="flex gap-2">
                                                        <button className="action-btn" onClick={() => openLinkModal(sIndex)} title="ÿ•ÿ∂ÿßŸÅÿ© ÿ±ÿßÿ®ÿ∑ ÿØÿßÿÆŸÑ Ÿáÿ∞Ÿá ÿßŸÑÿÆÿßŸÜÿ©"><i className="fa-solid fa-plus"></i></button>
                                                        <button className="action-btn" onClick={() => editSectionName(currentCourse.id, sIndex)} title="ÿ™ÿπÿØŸäŸÑ ÿßÿ≥ŸÖ ÿßŸÑÿÆÿßŸÜÿ©"><i className="fa-solid fa-pen"></i></button>
                                                        <button className="action-btn delete" onClick={() => deleteSection(currentCourse.id, sIndex)} title="ÿ≠ÿ∞ŸÅ ÿßŸÑÿÆÿßŸÜÿ©"><i className="fa-solid fa-trash"></i></button>
                                                    </div>
                                                </div>
                                                <ul className="list-none p-0">
                                                    {section.links.map((link, lIndex) => (
                                                        <li
                                                            key={lIndex}
                                                            className={`track-item ${draggedLinkInfo?.sectionIndex === sIndex && draggedLinkInfo?.linkIndex === lIndex ? 'dragging' : ''}`}
                                                            draggable
                                                            onDragStart={(e) => handleLinkDragStart(e, sIndex, lIndex)}
                                                            onDragOver={handleLinkDragOver}
                                                            onDrop={(e) => handleLinkDrop(e, sIndex, lIndex)}
                                                            onDragLeave={(e) => e.currentTarget.classList.remove('drag-over')}
                                                            onDragEnter={(e) => { if (draggedLinkInfo && (draggedLinkInfo.sectionIndex !== sIndex || draggedLinkInfo.linkIndex !== lIndex)) e.currentTarget.classList.add('drag-over') }}
                                                        >
                                                            <i className="fa-solid fa-grip-vertical text-[var(--text-secondary)] ml-3 cursor-grab hover:text-[var(--primary)]"></i>
                                                            <div className="text-[var(--text-secondary)] ml-3"><i className="fa-solid fa-link"></i></div>
                                                            <div className="flex-grow overflow-hidden" onClick={() => window.open(link.url, '_blank')}>
                                                                <span className="font-semibold text-sm truncate block">{link.name}</span>
                                                            </div>
                                                            <i className="fa-solid fa-play text-[var(--primary)] text-xs opacity-0 hover:opacity-100 transition-opacity flex-shrink-0"></i>
                                                            <button className="bg-transparent border-none text-[var(--text-secondary)] cursor-pointer ml-3 hover:text-[var(--primary)] transition-colors flex-shrink-0" onClick={() => openEditLinkModal(currentCourse.id, sIndex, lIndex)} title="ÿ™ÿπÿØŸäŸÑ ÿßŸÑÿ±ÿßÿ®ÿ∑"><i className="fa-solid fa-pen"></i></button>
                                                            <button className="bg-transparent border-none text-[var(--text-secondary)] cursor-pointer ml-3 hover:text-[var(--danger)] transition-colors flex-shrink-0" onClick={() => deleteLink(currentCourse.id, sIndex, lIndex)} title="ÿ≠ÿ∞ŸÅ ÿßŸÑÿ±ÿßÿ®ÿ∑"><i className="fa-solid fa-trash"></i></button>
                                                        </li>
                                                    ))}
                                                </ul>
                                            </div>
                                        ))
                                    )}
                                </div>
                            </div>
                        )}
                    </main>

                    <footer className="text-center py-8 text-[var(--text-secondary)] text-sm border-t border-[var(--border-color)]">
                        <p>¬© 2026 CCE Hub. ŸÜÿ∏ÿßŸÖ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑŸÖŸàÿ≠ÿØ.</p>
                    </footer>

                    {/* Modals */}
                    {courseModalOpen && (
                        <div className="modal-backdrop" role="dialog" onClick={() => setCourseModalOpen(false)}>
                            <div onClick={e => e.stopPropagation()}>
                                <h2 className="text-2xl font-bold text-[var(--primary-dark)] mb-6 text-center">
                                    {editingCourseId ? 'ÿ™ÿπÿØŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖŸÇÿ±ÿ±' : 'ÿ•ÿ∂ÿßŸÅÿ© ŸÖŸÇÿ±ÿ± ÿ¨ÿØŸäÿØ'}
                                </h2>
                                
                                <div className="mb-6">
                                    <label className="block mb-2 font-bold text-[var(--text-primary)]">ÿßÿ≥ŸÖ ÿßŸÑŸÖŸÇÿ±ÿ±</label>
                                    <input
                                        className="form-input"
                                        value={courseName}
                                        onChange={(e) => setCourseName(e.target.value)}
                                        placeholder="ŸÖÿ´ÿßŸÑ: ŸÅŸäÿ≤Ÿäÿßÿ° ÿßŸÑÿ≠ÿßŸÑÿ© ÿßŸÑÿµŸÑÿ®ÿ©"
                                    />
                                </div>
                                
                                <div className="mb-6">
                                    <label className="block mb-2 font-bold text-[var(--text-primary)]">ÿßÿ≥ŸÖ ÿßŸÑÿØŸÉÿ™Ÿàÿ± / ÿßŸÑŸÖŸÑÿßÿ≠ÿ∏ÿ©</label>
                                    <input
                                        className="form-input"
                                        value={courseDoc}
                                        onChange={(e) => setCourseDoc(e.target.value)}
                                        placeholder="ŸÖÿ´ÿßŸÑ: ÿØŸÉÿ™Ÿàÿ± ŸÅŸÑÿßŸÜ"
                                    />
                                </div>
                                
                                <div className="mb-6">
                                    <label className="block mb-2 font-bold text-[var(--text-primary)]">ÿ£ŸäŸÇŸàŸÜÿ© ÿßŸÑŸÖŸÇÿ±ÿ± (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä - PNG)</label>
                                    <div className="flex items-center gap-4 flex-wrap">
                                        <button
                                            type="button"
                                            className="bg-[var(--bg-body)] text-[var(--text-primary)] border-2 border-dashed border-[var(--border-color)] px-4 py-3 rounded-lg cursor-pointer font-bold hover:border-[var(--primary)] hover:text-[var(--primary)] transition-colors flex items-center gap-2"
                                            onClick={() => fileInputRef.current?.click()}
                                        >
                                            <i className="fa-solid fa-image"></i> ÿ±ŸÅÿπ ÿµŸàÿ±ÿ©
                                        </button>
                                        {currentIconBase64 && (
                                            <div className="w-16 h-16 rounded-full overflow-hidden border-2 border-[var(--border-color)] flex-shrink-0">
                                                <img src={currentIconBase64} alt="Preview" className="w-full h-full object-cover" />
                                            </div>
                                        )}
                                        {editingCourseId && !currentIconBase64 && currentCourse?.icon.startsWith('data:image') && (
                                            <div className="w-16 h-16 rounded-full overflow-hidden border-2 border-[var(--border-color)] flex-shrink-0">
                                                <img src={currentCourse.icon} alt="Current" className="w-full h-full object-cover" />
                                            </div>
                                        )}
                                        <input
                                            ref={fileInputRef}
                                            type="file"
                                            accept="image/png"
                                            onChange={handleImageUpload}
                                            style={{ display: 'none' }}
                                        />
                                    </div>
                                </div>

                                <div className="mt-8 pt-4 border-t border-[var(--border-color)] flex justify-end gap-3 flex-wrap">
                                    {editingCourseId && (
                                        <button
                                            className="btn-delete"
                                            onClick={() => {
                                                if (confirm('ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ≠ÿ∞ŸÅ Ÿáÿ∞ÿß ÿßŸÑŸÖŸÇÿ±ÿ± Ÿàÿ¨ŸÖŸäÿπ ŸÖÿ≠ÿ™ŸàŸäÿßÿ™Ÿáÿü')) {
                                                    deleteCourse(editingCourseId)
                                                    setCourseModalOpen(false)
                                                    showHome()
                                                }
                                            }}
                                        >
                                            ÿ≠ÿ∞ŸÅ ÿßŸÑŸÖŸÇÿ±ÿ±
                                        </button>
                                    )}
                                    <div className="flex-grow"></div>
                                    <button className="btn-cancel" onClick={() => setCourseModalOpen(false)}>ÿ•ŸÑÿ∫ÿßÿ°</button>
                                    <button className="btn-save" onClick={saveCourseData}>ÿ≠ŸÅÿ∏</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {noteModalOpen && (
                        <div className="modal-backdrop" role="dialog" onClick={() => setNoteModalOpen(false)}>
                            <div onClick={e => e.stopPropagation()} className="max-w-md !important">
                                <h2 className="text-2xl font-bold text-[var(--primary-dark)] mb-6 text-center">
                                    {editingNoteId ? 'ÿ™ÿπÿØŸäŸÑ ÿßŸÑŸÖŸÑÿßÿ≠ÿ∏ÿ©' : 'ÿ•ÿ∂ÿßŸÅÿ© ŸÖŸÑÿßÿ≠ÿ∏ÿ© ÿ¨ÿØŸäÿØÿ©'}
                                </h2>
                                
                                <div className="mb-6">
                                    <textarea
                                        className="form-input min-h-[150px]"
                                        value={tempNoteContent}
                                        onChange={(e) => setTempNoteContent(e.target.value)}
                                        placeholder="ÿßŸÉÿ™ÿ® ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ŸÉ ŸáŸÜÿß..."
                                    ></textarea>
                                </div>

                                <div className="mt-8 pt-4 border-t border-[var(--border-color)] flex justify-end gap-3">
                                    <button className="btn-cancel" onClick={() => setNoteModalOpen(false)}>ÿ•ŸÑÿ∫ÿßÿ°</button>
                                    <button className="btn-save" onClick={saveNote}>ÿ≠ŸÅÿ∏</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {linkModalOpen && (
                        <div className="modal-backdrop" role="dialog" onClick={() => setLinkModalOpen(false)}>
                            <div onClick={e => e.stopPropagation()}>
                                <h2 className="text-2xl font-bold text-[var(--primary-dark)] mb-6 text-center">
                                    {targetSectionIndex !== null ? 'ÿ•ÿ∂ÿßŸÅÿ© ÿ±ÿßÿ®ÿ∑ ŸÑŸÑÿÆÿßŸÜÿ©' : 'ÿ•ÿ∂ÿßŸÅÿ© ÿÆÿßŸÜÿ© ÿ¨ÿØŸäÿØÿ©'}
                                </h2>
                                
                                <div className="mb-6">
                                    <label className="block mb-2 font-bold text-[var(--text-primary)]">ÿßÿ≥ŸÖ ÿßŸÑÿ±ÿßÿ®ÿ∑</label>
                                    <input
                                        className="form-input"
                                        value={linkName}
                                        onChange={(e) => setLinkName(e.target.value)}
                                        placeholder="ŸÖÿ´ÿßŸÑ: ÿ¥ÿßÿ®ÿ™ÿ± 1ÿå ÿ¥ÿ±ÿ≠ ŸÉÿßŸÖŸÑ"
                                    />
                                </div>
                                
                                <div className="mb-6">
                                    <label className="block mb-2 font-bold text-[var(--text-primary)]">ÿßŸÑÿ±ÿßÿ®ÿ∑</label>
                                    <input
                                        className="form-input"
                                        value={linkUrl}
                                        onChange={(e) => setLinkUrl(e.target.value)}
                                        placeholder="https://..."
                                    />
                                </div>

                                <div className="mt-8 pt-4 border-t border-[var(--border-color)] flex justify-end gap-3">
                                    <button className="btn-cancel" onClick={() => setLinkModalOpen(false)}>ÿ•ŸÑÿ∫ÿßÿ°</button>
                                    <button className="btn-save" onClick={saveLinkData}>ÿ≠ŸÅÿ∏ ÿßŸÑÿ±ÿßÿ®ÿ∑</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {editLinkModalOpen && (
                        <div className="modal-backdrop" role="dialog" onClick={() => setEditLinkModalOpen(false)}>
                            <div onClick={e => e.stopPropagation()}>
                                <h2 className="text-2xl font-bold text-[var(--primary-dark)] mb-6 text-center">ÿ™ÿπÿØŸäŸÑ ÿßŸÑÿ±ÿßÿ®ÿ∑</h2>
                                
                                <div className="mb-6">
                                    <label className="block mb-2 font-bold text-[var(--text-primary)]">ÿßÿ≥ŸÖ ÿßŸÑÿ±ÿßÿ®ÿ∑</label>
                                    <input
                                        className="form-input"
                                        value={editLinkName}
                                        onChange={(e) => setEditLinkName(e.target.value)}
                                        placeholder="ÿßÿ≥ŸÖ ÿßŸÑÿ±ÿßÿ®ÿ∑"
                                    />
                                </div>
                                
                                <div className="mb-6">
                                    <label className="block mb-2 font-bold text-[var(--text-primary)]">ÿßŸÑÿ±ÿßÿ®ÿ∑</label>
                                    <input
                                        className="form-input"
                                        value={editLinkUrl}
                                        onChange={(e) => setEditLinkUrl(e.target.value)}
                                        placeholder="https://..."
                                    />
                                </div>

                                <div className="mt-8 pt-4 border-t border-[var(--border-color)] flex justify-end gap-3">
                                    <button className="btn-cancel" onClick={() => setEditLinkModalOpen(false)}>ÿ•ŸÑÿ∫ÿßÿ°</button>
                                    <button className="btn-save" onClick={saveEditedLink}>ÿ≠ŸÅÿ∏ ÿßŸÑÿ™ÿπÿØŸäŸÑÿßÿ™</button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<CCEHub />);
    </script>
</body>
</html>
